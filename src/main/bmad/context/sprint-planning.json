[
  {
    "id": "01cd2110-d039-4854-9b50-49220ddac2d4",
    "role": "user",
    "content": "Execute the sprint-planning workflow by following these steps:\n\nIT IS CRITICAL THAT YOU FOLLOW THESE STEPS - while staying in character as the current agent persona you may have loaded:\n\n<steps CRITICAL=\"TRUE\">\n1. Always LOAD the FULL _bmad/core/tasks/workflow.xml\n2. READ its entire contents - this is the CORE OS for EXECUTING the specific workflow-config _bmad/bmm/workflows/4-implementation/sprint-planning/workflow.yaml\n3. Pass the yaml path _bmad/bmm/workflows/4-implementation/sprint-planning/workflow.yaml as 'workflow-config' parameter to the workflow.xml instructions\n4. Follow workflow.xml instructions EXACTLY as written to process and follow the specific workflow config and its instructions\n5. Save outputs after EACH section when generating any documents from templates\n</steps>",
    "promptContext": {
      "id": "01cd2110-d039-4854-9b50-49220ddac2d4",
      "group": {
        "id": "01cd2110-d039-4854-9b50-49220ddac2d4"
      }
    }
  },
  {
    "id": "5c6f2b07-7d39-477e-9a15-055b09570d1d",
    "role": "assistant",
    "content": [
      {
        "type": "text",
        "text": "I'll execute the sprint-planning workflow by first loading and reading the core workflow.xml file."
      },
      {
        "type": "tool-call",
        "toolCallId": "call_858dffedf58c481da3a2f02e",
        "toolName": "power---file_read",
        "input": {
          "filePath": "_bmad/core/tasks/workflow.xml",
          "withLines": false,
          "lineOffset": 0,
          "lineLimit": 1000
        }
      }
    ],
    "promptContext": {
      "id": "01cd2110-d039-4854-9b50-49220ddac2d4",
      "group": {
        "id": "01cd2110-d039-4854-9b50-49220ddac2d4"
      }
    }
  },
  {
    "id": "95336b76-dddc-45e6-8223-947fcc5439bf",
    "role": "tool",
    "content": [
      {
        "type": "tool-result",
        "toolCallId": "call_858dffedf58c481da3a2f02e",
        "toolName": "power---file_read",
        "output": {
          "type": "text",
          "value": "<task id=\"_bmad/core/tasks/workflow.xml\" name=\"Execute Workflow\" standalone=\"false\">\n  <objective>Execute given workflow by loading its configuration, following instructions, and producing output</objective>\n\n  <llm critical=\"true\">\n    <mandate>Always read COMPLETE files - NEVER use offset/limit when reading any workflow related files</mandate>\n    <mandate>Instructions are MANDATORY - either as file path, steps or embedded list in YAML, XML or markdown</mandate>\n    <mandate>Execute ALL steps in instructions IN EXACT ORDER</mandate>\n    <mandate>Save to template output file after EVERY \"template-output\" tag</mandate>\n    <mandate>NEVER skip a step - YOU are responsible for every steps execution without fail or excuse</mandate>\n  </llm>\n\n  <WORKFLOW-RULES critical=\"true\">\n    <rule n=\"1\">Steps execute in exact numerical order (1, 2, 3...)</rule>\n    <rule n=\"2\">Optional steps: Ask user unless #yolo mode active</rule>\n    <rule n=\"3\">Template-output tags: Save content, discuss with the user the section completed, and NEVER proceed until the users indicates\n      to proceed (unless YOLO mode has been activated)</rule>\n  </WORKFLOW-RULES>\n\n  <flow>\n    <step n=\"1\" title=\"Load and Initialize Workflow\">\n      <substep n=\"1a\" title=\"Load Configuration and Resolve Variables\">\n        <action>Read workflow.yaml from provided path</action>\n        <mandate>Load config_source (REQUIRED for all modules)</mandate>\n        <phase n=\"1\">Load external config from config_source path</phase>\n        <phase n=\"2\">Resolve all {config_source}: references with values from config</phase>\n        <phase n=\"3\">Resolve system variables (date:system-generated) and paths ({project-root}, {installed_path})</phase>\n        <phase n=\"4\">Ask user for input of any variables that are still unknown</phase>\n      </substep>\n\n      <substep n=\"1b\" title=\"Load Required Components\">\n        <mandate>Instructions: Read COMPLETE file from path OR embedded list (REQUIRED)</mandate>\n        <check>If template path â†’ Read COMPLETE template file</check>\n        <check>If validation path â†’ Note path for later loading when needed</check>\n        <check>If template: false â†’ Mark as action-workflow (else template-workflow)</check>\n        <note>Data files (csv, json) â†’ Store paths only, load on-demand when instructions reference them</note>\n      </substep>\n\n      <substep n=\"1c\" title=\"Initialize Output\" if=\"template-workflow\">\n        <action>Resolve default_output_file path with all variables and {{date}}</action>\n        <action>Create output directory if doesn't exist</action>\n        <action>If template-workflow â†’ Write template to output file with placeholders</action>\n        <action>If action-workflow â†’ Skip file creation</action>\n      </substep>\n    </step>\n\n    <step n=\"2\" title=\"Process Each Instruction Step in Order\">\n      <iterate>For each step in instructions:</iterate>\n\n      <substep n=\"2a\" title=\"Handle Step Attributes\">\n        <check>If optional=\"true\" and NOT #yolo â†’ Ask user to include</check>\n        <check>If if=\"condition\" â†’ Evaluate condition</check>\n        <check>If for-each=\"item\" â†’ Repeat step for each item</check>\n        <check>If repeat=\"n\" â†’ Repeat step n times</check>\n      </substep>\n\n      <substep n=\"2b\" title=\"Execute Step Content\">\n        <action>Process step instructions (markdown or XML tags)</action>\n        <action>Replace {{variables}} with values (ask user if unknown)</action>\n        <execute-tags>\n          <tag>action xml tag â†’ Perform the action</tag>\n          <tag>check if=\"condition\" xml tag â†’ Conditional block wrapping actions (requires closing &lt;/check&gt;)</tag>\n          <tag>ask xml tag â†’ Prompt user and WAIT for response</tag>\n          <tag>invoke-workflow xml tag â†’ Execute another workflow with given inputs and the workflow.xml runner</tag>\n          <tag>invoke-task xml tag â†’ Execute specified task</tag>\n          <tag>invoke-protocol name=\"protocol_name\" xml tag â†’ Execute reusable protocol from protocols section</tag>\n          <tag>goto step=\"x\" â†’ Jump to specified step</tag>\n        </execute-tags>\n      </substep>\n\n      <substep n=\"2c\" title=\"Handle template-output Tags\">\n        <if tag=\"template-output\">\n          <mandate>Generate content for this section</mandate>\n          <mandate>Save to file (Write first time, Edit subsequent)</mandate>\n          <action>Display generated content</action>\n          <ask> [a] Advanced Elicitation, [c] Continue, [p] Party-Mode, [y] YOLO the rest of this document only. WAIT for response. <if\n              response=\"a\">\n              <action>Start the advanced elicitation workflow {project-root}/_bmad/core/workflows/advanced-elicitation/workflow.xml</action>\n            </if>\n            <if\n              response=\"c\">\n              <action>Continue to next step</action>\n            </if>\n            <if response=\"p\">\n              <action>Start the party-mode workflow {project-root}/_bmad/core/workflows/party-mode/workflow.md</action>\n            </if>\n            <if\n              response=\"y\">\n              <action>Enter #yolo mode for the rest of the workflow</action>\n            </if>\n          </ask>\n        </if>\n      </substep>\n\n      <substep n=\"2d\" title=\"Step Completion\">\n        <check>If no special tags and NOT #yolo:</check>\n        <ask>Continue to next step? (y/n/edit)</ask>\n      </substep>\n    </step>\n\n    <step n=\"3\" title=\"Completion\">\n      <check>Confirm document saved to output path</check>\n      <action>Report workflow completion</action>\n    </step>\n  </flow>\n\n  <execution-modes>\n    <mode name=\"normal\">Full user interaction and confirmation of EVERY step at EVERY template output - NO EXCEPTIONS except yolo MODE</mode>\n    <mode name=\"yolo\">Skip all confirmations and elicitation, minimize prompts and try to produce all of the workflow automatically by\n      simulating the remaining discussions with an simulated expert user</mode>\n  </execution-modes>\n\n  <supported-tags desc=\"Instructions can use these tags\">\n    <structural>\n      <tag>step n=\"X\" goal=\"...\" - Define step with number and goal</tag>\n      <tag>optional=\"true\" - Step can be skipped</tag>\n      <tag>if=\"condition\" - Conditional execution</tag>\n      <tag>for-each=\"collection\" - Iterate over items</tag>\n      <tag>repeat=\"n\" - Repeat n times</tag>\n    </structural>\n    <execution>\n      <tag>action - Required action to perform</tag>\n      <tag>action if=\"condition\" - Single conditional action (inline, no closing tag needed)</tag>\n      <tag>check if=\"condition\"&gt;...&lt;/check&gt; - Conditional block wrapping multiple items (closing tag required)</tag>\n      <tag>ask - Get user input (ALWAYS wait for response before continuing)</tag>\n      <tag>goto - Jump to another step</tag>\n      <tag>invoke-workflow - Call another workflow</tag>\n      <tag>invoke-task - Call a task</tag>\n      <tag>invoke-protocol - Execute a reusable protocol (e.g., discover_inputs)</tag>\n    </execution>\n    <output>\n      <tag>template-output - Save content checkpoint</tag>\n      <tag>critical - Cannot be skipped</tag>\n      <tag>example - Show example output</tag>\n    </output>\n  </supported-tags>\n\n  <protocols desc=\"Reusable workflow protocols that can be invoked via invoke-protocol tag\">\n    <protocol name=\"discover_inputs\" desc=\"Smart file discovery and loading based on input_file_patterns\">\n      <objective>Intelligently load project files (whole or sharded) based on workflow's input_file_patterns configuration</objective>\n\n      <critical>Only execute if workflow.yaml contains input_file_patterns section</critical>\n\n      <flow>\n        <step n=\"1\" title=\"Parse Input File Patterns\">\n          <action>Read input_file_patterns from loaded workflow.yaml</action>\n          <action>For each pattern group (prd, architecture, epics, etc.), note the load_strategy if present</action>\n        </step>\n\n        <step n=\"2\" title=\"Load Files Using Smart Strategies\">\n          <iterate>For each pattern in input_file_patterns:</iterate>\n\n          <substep n=\"2a\" title=\"Try Sharded Documents First\">\n            <check if=\"sharded pattern exists\">\n              <action>Determine load_strategy from pattern config (defaults to FULL_LOAD if not specified)</action>\n\n              <strategy name=\"FULL_LOAD\">\n                <desc>Load ALL files in sharded directory - used for PRD, Architecture, UX, brownfield docs</desc>\n                <action>Use glob pattern to find ALL .md files (e.g., \"{output_folder}/*architecture*/*.md\")</action>\n                <action>Load EVERY matching file completely</action>\n                <action>Concatenate content in logical order (index.md first if exists, then alphabetical)</action>\n                <action>Store in variable: {pattern_name_content}</action>\n              </strategy>\n\n              <strategy name=\"SELECTIVE_LOAD\">\n                <desc>Load specific shard using template variable - example: used for epics with {{epic_num}}</desc>\n                <action>Check for template variables in sharded_single pattern (e.g., {{epic_num}})</action>\n                <action>If variable undefined, ask user for value OR infer from context</action>\n                <action>Resolve template to specific file path</action>\n                <action>Load that specific file</action>\n                <action>Store in variable: {pattern_name_content}</action>\n              </strategy>\n\n              <strategy name=\"INDEX_GUIDED\">\n                <desc>Load index.md, analyze structure and description of each doc in the index, then intelligently load relevant docs</desc>\n                <mandate>DO NOT BE LAZY - use best judgment to load documents that might have relevant information, even if only a 5% chance</mandate>\n                <action>Load index.md from sharded directory</action>\n                <action>Parse table of contents, links, section headers</action>\n                <action>Analyze workflow's purpose and objective</action>\n                <action>Identify which linked/referenced documents are likely relevant</action>\n                <example>If workflow is about authentication and index shows \"Auth Overview\", \"Payment Setup\", \"Deployment\" â†’ Load auth\n                  docs, consider deployment docs, skip payment</example>\n                <action>Load all identified relevant documents</action>\n                <action>Store combined content in variable: {pattern_name_content}</action>\n                <note>When in doubt, LOAD IT - context is valuable, being thorough is better than missing critical info</note>\n              </strategy>\n              <action>Mark pattern as RESOLVED, skip to next pattern</action>\n            </check>\n          </substep>\n\n          <substep n=\"2b\" title=\"Try Whole Document if No Sharded Found\">\n            <check if=\"no sharded matches found OR no sharded pattern exists\">\n              <action>Attempt glob match on 'whole' pattern (e.g., \"{output_folder}/*prd*.md\")</action>\n              <check if=\"matches found\">\n                <action>Load ALL matching files completely (no offset/limit)</action>\n                <action>Store content in variable: {pattern_name_content} (e.g., {prd_content})</action>\n                <action>Mark pattern as RESOLVED, skip to next pattern</action>\n              </check>\n            </check>\n          </substep>\n\n          <substep n=\"2c\" title=\"Handle Not Found\">\n            <check if=\"no matches for sharded OR whole\">\n              <action>Set {pattern_name_content} to empty string</action>\n              <action>Note in session: \"No {pattern_name} files found\" (not an error, just unavailable, offer use change to provide)</action>\n            </check>\n          </substep>\n        </step>\n\n        <step n=\"3\" title=\"Report Discovery Results\">\n          <action>List all loaded content variables with file counts</action>\n          <example>\n            âœ“ Loaded {prd_content} from 5 sharded files: prd/index.md, prd/requirements.md, ...\n            âœ“ Loaded {architecture_content} from 1 file: Architecture.md\n            âœ“ Loaded {epics_content} from selective load: epics/epic-3.md\n            â—‹ No ux_design files found\n          </example>\n          <note>This gives workflow transparency into what context is available</note>\n        </step>\n      </flow>\n\n    </protocol>\n  </protocols>\n\n  <llm final=\"true\">\n    <critical-rules>\n      â€¢ This is the complete workflow execution engine\n      â€¢ You MUST Follow instructions exactly as written\n      â€¢ The workflow execution engine is governed by: {project-root}/_bmad/core/tasks/workflow.xml\n      â€¢ You MUST have already loaded and processed: {installed_path}/workflow.yaml\n      â€¢ This workflow uses INTENT-DRIVEN PLANNING - adapt organically to product type and context\n      â€¢ YOU ARE FACILITATING A CONVERSATION With a user to produce a final document step by step. The whole process is meant to be\n      collaborative helping the user flesh out their ideas. Do not rush or optimize and skip any section.\n    </critical-rules>\n  </llm>\n</task> "
        }
      }
    ],
    "promptContext": {
      "id": "01cd2110-d039-4854-9b50-49220ddac2d4",
      "group": {
        "id": "01cd2110-d039-4854-9b50-49220ddac2d4"
      }
    }
  },
  {
    "id": "66768efb-3e0f-4abe-9236-a04446a26735",
    "role": "assistant",
    "content": [
      {
        "type": "text",
        "text": "Now I need to read the sprint-planning workflow configuration file."
      },
      {
        "type": "tool-call",
        "toolCallId": "call_0150077582404a738a8474eb",
        "toolName": "power---file_read",
        "input": {
          "filePath": "_bmad/bmm/workflows/4-implementation/sprint-planning/workflow.yaml",
          "withLines": false,
          "lineOffset": 0,
          "lineLimit": 1000
        }
      }
    ],
    "promptContext": {
      "id": "01cd2110-d039-4854-9b50-49220ddac2d4",
      "group": {
        "id": "01cd2110-d039-4854-9b50-49220ddac2d4"
      }
    }
  },
  {
    "id": "9b23bc7a-6861-4889-8e3a-acbee8cb7595",
    "role": "tool",
    "content": [
      {
        "type": "tool-result",
        "toolCallId": "call_0150077582404a738a8474eb",
        "toolName": "power---file_read",
        "output": {
          "type": "text",
          "value": "name: sprint-planning\ndescription: \"Generate and manage the sprint status tracking file for Phase 4 implementation, extracting all epics and stories from epic files and tracking their status through the development lifecycle\"\nauthor: \"BMad\"\n\n# Critical variables from config\nconfig_source: \"{project-root}/_bmad/bmm/config.yaml\"\nuser_name: \"{config_source}:user_name\"\ncommunication_language: \"{config_source}:communication_language\"\ndate: system-generated\nimplementation_artifacts: \"{config_source}:implementation_artifacts\"\nplanning_artifacts: \"{config_source}:planning_artifacts\"\noutput_folder: \"{implementation_artifacts}\"\n\n# Workflow components\ninstalled_path: \"{project-root}/_bmad/bmm/workflows/4-implementation/sprint-planning\"\ninstructions: \"{installed_path}/instructions.md\"\ntemplate: \"{installed_path}/sprint-status-template.yaml\"\nvalidation: \"{installed_path}/checklist.md\"\n\n# Variables and inputs\nvariables:\n  # Project context\n  project_context: \"**/project-context.md\"\n  # Project identification\n  project_name: \"{config_source}:project_name\"\n\n  # Tracking system configuration\n  tracking_system: \"file-system\" # Options: file-system, Future will support other options from config of mcp such as jira, linear, trello\n  project_key: \"NOKEY\" # Placeholder for tracker integrations; file-system uses a no-op key\n  story_location: \"{config_source}:implementation_artifacts\" # Relative path for file-system, Future will support URL for Jira/Linear/Trello\n  story_location_absolute: \"{config_source}:implementation_artifacts\" # Absolute path for file operations\n\n  # Source files (file-system only)\n  epics_location: \"{planning_artifacts}\" # Directory containing epic*.md files\n  epics_pattern: \"epic*.md\" # Pattern to find epic files\n\n  # Output configuration\n  status_file: \"{implementation_artifacts}/sprint-status.yaml\"\n\n# Smart input file references - handles both whole docs and sharded docs\n# Priority: Whole document first, then sharded version\n# Strategy: FULL LOAD - sprint planning needs ALL epics to build complete status\ninput_file_patterns:\n  epics:\n    description: \"All epics with user stories\"\n    whole: \"{output_folder}/*epic*.md\"\n    sharded: \"{output_folder}/*epic*/*.md\"\n    load_strategy: \"FULL_LOAD\"\n\n# Output configuration\ndefault_output_file: \"{status_file}\"\n\nstandalone: true\n"
        }
      }
    ],
    "promptContext": {
      "id": "01cd2110-d039-4854-9b50-49220ddac2d4",
      "group": {
        "id": "01cd2110-d039-4854-9b50-49220ddac2d4"
      }
    }
  },
  {
    "id": "c9bc4884-1a84-46b6-81ed-8f51cea9894f",
    "role": "assistant",
    "content": [
      {
        "type": "text",
        "text": "Good, I have loaded the workflow.xml and the workflow.yaml for sprint-planning. Now let me proceed according to the workflow.xml instructions:\n\nStep 1: Load and Initialize Workflow\n1a: Load Configuration and Resolve Variables\n- Need to load config from {project-root}/_bmad/bmm/config.yaml\n- Resolve all {config_source}: references\n- Resolve system variables and paths\n- Ask user for any unknown variables\n\nLet me first load the config.yaml file:"
      },
      {
        "type": "tool-call",
        "toolCallId": "call_85970354dc7946b2b2458067",
        "toolName": "power---file_read",
        "input": {
          "filePath": "_bmad/bmm/config.yaml",
          "withLines": false,
          "lineOffset": 0,
          "lineLimit": 1000
        }
      }
    ],
    "promptContext": {
      "id": "01cd2110-d039-4854-9b50-49220ddac2d4",
      "group": {
        "id": "01cd2110-d039-4854-9b50-49220ddac2d4"
      }
    }
  },
  {
    "id": "67e04834-6077-46c2-aef8-db3b9202d5d4",
    "role": "tool",
    "content": [
      {
        "type": "tool-result",
        "toolCallId": "call_85970354dc7946b2b2458067",
        "toolName": "power---file_read",
        "output": {
          "type": "text",
          "value": "# BMM Module Configuration\n# Generated by BMAD installer\n# Version: 6.0.0-Beta.5\n# Date: 2026-02-03T14:30:35.442Z\n\nproject_name: aider-desk\nuser_skill_level: intermediate\nplanning_artifacts: \"{project-root}/_bmad-output/planning-artifacts\"\nimplementation_artifacts: \"{project-root}/_bmad-output/implementation-artifacts\"\nproject_knowledge: \"{project-root}/docs\"\n\n# Core Configuration Values\nuser_name: Wlad\ncommunication_language: English\ndocument_output_language: English\noutput_folder: \"{project-root}/_bmad-output\"\n"
        }
      }
    ],
    "promptContext": {
      "id": "01cd2110-d039-4854-9b50-49220ddac2d4",
      "group": {
        "id": "01cd2110-d039-4854-9b50-49220ddac2d4"
      }
    }
  },
  {
    "id": "36521712-e47f-4b72-8147-b73cbd91f337",
    "role": "assistant",
    "content": [
      {
        "type": "text",
        "text": "Now I need to load the instructions file and the template file to understand what the workflow requires me to do."
      },
      {
        "type": "tool-call",
        "toolCallId": "call_1d1b1301020f41b4bdb56a63",
        "toolName": "power---file_read",
        "input": {
          "filePath": "_bmad/bmm/workflows/4-implementation/sprint-planning/instructions.md",
          "withLines": false,
          "lineOffset": 0,
          "lineLimit": 1000
        }
      }
    ],
    "promptContext": {
      "id": "01cd2110-d039-4854-9b50-49220ddac2d4",
      "group": {
        "id": "01cd2110-d039-4854-9b50-49220ddac2d4"
      }
    }
  },
  {
    "id": "0ba4572e-ad7a-4531-a5da-193b977cb520",
    "role": "tool",
    "content": [
      {
        "type": "tool-result",
        "toolCallId": "call_1d1b1301020f41b4bdb56a63",
        "toolName": "power---file_read",
        "output": {
          "type": "text",
          "value": "# Sprint Planning - Sprint Status Generator\n\n<critical>The workflow execution engine is governed by: {project-root}/_bmad/core/tasks/workflow.xml</critical>\n<critical>You MUST have already loaded and processed: {project-root}/_bmad/bmm/workflows/4-implementation/sprint-planning/workflow.yaml</critical>\n\n## ðŸ“š Document Discovery - Full Epic Loading\n\n**Strategy**: Sprint planning needs ALL epics and stories to build complete status tracking.\n\n**Epic Discovery Process:**\n\n1. **Search for whole document first** - Look for `epics.md`, `bmm-epics.md`, or any `*epic*.md` file\n2. **Check for sharded version** - If whole document not found, look for `epics/index.md`\n3. **If sharded version found**:\n   - Read `index.md` to understand the document structure\n   - Read ALL epic section files listed in the index (e.g., `epic-1.md`, `epic-2.md`, etc.)\n   - Process all epics and their stories from the combined content\n   - This ensures complete sprint status coverage\n4. **Priority**: If both whole and sharded versions exist, use the whole document\n\n**Fuzzy matching**: Be flexible with document names - users may use variations like `epics.md`, `bmm-epics.md`, `user-stories.md`, etc.\n\n<workflow>\n\n<step n=\"1\" goal=\"Parse epic files and extract all work items\">\n<action>Communicate in {communication_language} with {user_name}</action>\n<action>Look for all files matching `{epics_pattern}` in {epics_location}</action>\n<action>Could be a single `epics.md` file or multiple `epic-1.md`, `epic-2.md` files</action>\n\n<action>For each epic file found, extract:</action>\n\n- Epic numbers from headers like `## Epic 1:` or `## Epic 2:`\n- Story IDs and titles from patterns like `### Story 1.1: User Authentication`\n- Convert story format from `Epic.Story: Title` to kebab-case key: `epic-story-title`\n\n**Story ID Conversion Rules:**\n\n- Original: `### Story 1.1: User Authentication`\n- Replace period with dash: `1-1`\n- Convert title to kebab-case: `user-authentication`\n- Final key: `1-1-user-authentication`\n\n<action>Build complete inventory of all epics and stories from all epic files</action>\n</step>\n\n  <step n=\"0.5\" goal=\"Discover and load project documents\">\n    <invoke-protocol name=\"discover_inputs\" />\n    <note>After discovery, these content variables are available: {epics_content} (all epics loaded - uses FULL_LOAD strategy)</note>\n  </step>\n\n<step n=\"2\" goal=\"Build sprint status structure\">\n<action>For each epic found, create entries in this order:</action>\n\n1. **Epic entry** - Key: `epic-{num}`, Default status: `backlog`\n2. **Story entries** - Key: `{epic}-{story}-{title}`, Default status: `backlog`\n3. **Retrospective entry** - Key: `epic-{num}-retrospective`, Default status: `optional`\n\n**Example structure:**\n\n```yaml\ndevelopment_status:\n  epic-1: backlog\n  1-1-user-authentication: backlog\n  1-2-account-management: backlog\n  epic-1-retrospective: optional\n```\n\n</step>\n\n<step n=\"3\" goal=\"Apply intelligent status detection\">\n<action>For each story, detect current status by checking files:</action>\n\n**Story file detection:**\n\n- Check: `{story_location_absolute}/{story-key}.md` (e.g., `stories/1-1-user-authentication.md`)\n- If exists â†’ upgrade status to at least `ready-for-dev`\n\n**Preservation rule:**\n\n- If existing `{status_file}` exists and has more advanced status, preserve it\n- Never downgrade status (e.g., don't change `done` to `ready-for-dev`)\n\n**Status Flow Reference:**\n\n- Epic: `backlog` â†’ `in-progress` â†’ `done`\n- Story: `backlog` â†’ `ready-for-dev` â†’ `in-progress` â†’ `review` â†’ `done`\n- Retrospective: `optional` â†” `done`\n  </step>\n\n<step n=\"4\" goal=\"Generate sprint status file\">\n<action>Create or update {status_file} with:</action>\n\n**File Structure:**\n\n```yaml\n# generated: {date}\n# project: {project_name}\n# project_key: {project_key}\n# tracking_system: {tracking_system}\n# story_location: {story_location}\n\n# STATUS DEFINITIONS:\n# ==================\n# Epic Status:\n#   - backlog: Epic not yet started\n#   - in-progress: Epic actively being worked on\n#   - done: All stories in epic completed\n#\n# Epic Status Transitions:\n#   - backlog â†’ in-progress: Automatically when first story is created (via create-story)\n#   - in-progress â†’ done: Manually when all stories reach 'done' status\n#\n# Story Status:\n#   - backlog: Story only exists in epic file\n#   - ready-for-dev: Story file created in stories folder\n#   - in-progress: Developer actively working on implementation\n#   - review: Ready for code review (via Dev's code-review workflow)\n#   - done: Story completed\n#\n# Retrospective Status:\n#   - optional: Can be completed but not required\n#   - done: Retrospective has been completed\n#\n# WORKFLOW NOTES:\n# ===============\n# - Epic transitions to 'in-progress' automatically when first story is created\n# - Stories can be worked in parallel if team capacity allows\n# - SM typically creates next story after previous one is 'done' to incorporate learnings\n# - Dev moves story to 'review', then runs code-review (fresh context, different LLM recommended)\n\ngenerated: { date }\nproject: { project_name }\nproject_key: { project_key }\ntracking_system: { tracking_system }\nstory_location: { story_location }\n\ndevelopment_status:\n  # All epics, stories, and retrospectives in order\n```\n\n<action>Write the complete sprint status YAML to {status_file}</action>\n<action>CRITICAL: Metadata appears TWICE - once as comments (#) for documentation, once as YAML key:value fields for parsing</action>\n<action>Ensure all items are ordered: epic, its stories, its retrospective, next epic...</action>\n</step>\n\n<step n=\"5\" goal=\"Validate and report\">\n<action>Perform validation checks:</action>\n\n- [ ] Every epic in epic files appears in {status_file}\n- [ ] Every story in epic files appears in {status_file}\n- [ ] Every epic has a corresponding retrospective entry\n- [ ] No items in {status_file} that don't exist in epic files\n- [ ] All status values are legal (match state machine definitions)\n- [ ] File is valid YAML syntax\n\n<action>Count totals:</action>\n\n- Total epics: {{epic_count}}\n- Total stories: {{story_count}}\n- Epics in-progress: {{in_progress_count}}\n- Stories done: {{done_count}}\n\n<action>Display completion summary to {user_name} in {communication_language}:</action>\n\n**Sprint Status Generated Successfully**\n\n- **File Location:** {status_file}\n- **Total Epics:** {{epic_count}}\n- **Total Stories:** {{story_count}}\n- **Epics In Progress:** {{epics_in_progress_count}}\n- **Stories Completed:** {{done_count}}\n\n**Next Steps:**\n\n1. Review the generated {status_file}\n2. Use this file to track development progress\n3. Agents will update statuses as they work\n4. Re-run this workflow to refresh auto-detected statuses\n\n</step>\n\n</workflow>\n\n## Additional Documentation\n\n### Status State Machine\n\n**Epic Status Flow:**\n\n```\nbacklog â†’ in-progress â†’ done\n```\n\n- **backlog**: Epic not yet started\n- **in-progress**: Epic actively being worked on (stories being created/implemented)\n- **done**: All stories in epic completed\n\n**Story Status Flow:**\n\n```\nbacklog â†’ ready-for-dev â†’ in-progress â†’ review â†’ done\n```\n\n- **backlog**: Story only exists in epic file\n- **ready-for-dev**: Story file created (e.g., `stories/1-3-plant-naming.md`)\n- **in-progress**: Developer actively working\n- **review**: Ready for code review (via Dev's code-review workflow)\n- **done**: Completed\n\n**Retrospective Status:**\n\n```\noptional â†” done\n```\n\n- **optional**: Ready to be conducted but not required\n- **done**: Finished\n\n### Guidelines\n\n1. **Epic Activation**: Mark epic as `in-progress` when starting work on its first story\n2. **Sequential Default**: Stories are typically worked in order, but parallel work is supported\n3. **Parallel Work Supported**: Multiple stories can be `in-progress` if team capacity allows\n4. **Review Before Done**: Stories should pass through `review` before `done`\n5. **Learning Transfer**: SM typically creates next story after previous one is `done` to incorporate learnings\n"
        }
      }
    ],
    "promptContext": {
      "id": "01cd2110-d039-4854-9b50-49220ddac2d4",
      "group": {
        "id": "01cd2110-d039-4854-9b50-49220ddac2d4"
      }
    }
  },
  {
    "id": "6898960f-8cfc-435b-a6bf-c6c64926b1ea",
    "role": "assistant",
    "content": [
      {
        "type": "text",
        "text": "Now let me read the template file to understand the structure I need to create."
      },
      {
        "type": "tool-call",
        "toolCallId": "call_d364c25eafd046bea01378e5",
        "toolName": "power---file_read",
        "input": {
          "filePath": "_bmad/bmm/workflows/4-implementation/sprint-planning/sprint-status-template.yaml",
          "withLines": false,
          "lineOffset": 0,
          "lineLimit": 1000
        }
      }
    ],
    "promptContext": {
      "id": "01cd2110-d039-4854-9b50-49220ddac2d4",
      "group": {
        "id": "01cd2110-d039-4854-9b50-49220ddac2d4"
      }
    }
  },
  {
    "id": "09cbb098-96a5-447b-b1b0-27cadb38f5d9",
    "role": "tool",
    "content": [
      {
        "type": "tool-result",
        "toolCallId": "call_d364c25eafd046bea01378e5",
        "toolName": "power---file_read",
        "output": {
          "type": "text",
          "value": "# Sprint Status Template\n# This is an EXAMPLE showing the expected format\n# The actual file will be generated with all epics/stories from your epic files\n\n# generated: {date}\n# project: {project_name}\n# project_key: {project_key}\n# tracking_system: {tracking_system}\n# story_location: {story_location}\n\n# STATUS DEFINITIONS:\n# ==================\n# Epic Status:\n#   - backlog: Epic not yet started\n#   - in-progress: Epic actively being worked on\n#   - done: All stories in epic completed\n#\n# Story Status:\n#   - backlog: Story only exists in epic file\n#   - ready-for-dev: Story file created, ready for development\n#   - in-progress: Developer actively working on implementation\n#   - review: Implementation complete, ready for review\n#   - done: Story completed\n#\n# Retrospective Status:\n#   - optional: Can be completed but not required\n#   - done: Retrospective has been completed\n#\n# WORKFLOW NOTES:\n# ===============\n# - Mark epic as 'in-progress' when starting work on its first story\n# - SM typically creates next story ONLY after previous one is 'done' to incorporate learnings\n# - Dev moves story to 'review', then Dev runs code-review (fresh context, ideally different LLM)\n\n# EXAMPLE STRUCTURE (your actual epics/stories will replace these):\n\ngenerated: 05-06-2-2025 21:30\nproject: My Awesome Project\nproject_key: NOKEY\ntracking_system: file-system\nstory_location: \"{story_location}\"\n\ndevelopment_status:\n  epic-1: backlog\n  1-1-user-authentication: done\n  1-2-account-management: ready-for-dev\n  1-3-plant-data-model: backlog\n  1-4-add-plant-manual: backlog\n  epic-1-retrospective: optional\n\n  epic-2: backlog\n  2-1-personality-system: backlog\n  2-2-chat-interface: backlog\n  2-3-llm-integration: backlog\n  epic-2-retrospective: optional\n"
        }
      }
    ],
    "promptContext": {
      "id": "01cd2110-d039-4854-9b50-49220ddac2d4",
      "group": {
        "id": "01cd2110-d039-4854-9b50-49220ddac2d4"
      }
    }
  },
  {
    "id": "dbc09378-d534-473b-9e1e-df992b539dcb",
    "role": "assistant",
    "content": [
      {
        "type": "text",
        "text": "Now I'll execute Step 0.5: Discover and load project documents using the discover_inputs protocol.\n\n**Step 0.5: Document Discovery - Loading Epic Files**\n\nI'll search for epic files in the implementation artifacts directory."
      }
    ],
    "promptContext": {
      "id": "01cd2110-d039-4854-9b50-49220ddac2d4",
      "group": {
        "id": "01cd2110-d039-4854-9b50-49220ddac2d4",
        "name": "Sprint Planning",
        "color": "#ef4444",
        "finished": true
      }
    }
  }
]
